<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>E-Gamify SMPN 42 Bandar Lampung</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>

    <div id="app-container">
        
        <!-- LOGIN SCREEN -->
        <section id="screen-login" class="screen active">
            <div class="login-wrapper">
                <div class="login-box">
                    <img src="logo.png" onerror="this.src='https://via.placeholder.com/100?text=LOGO'" alt="Logo" class="school-logo">
                    <h1>E-Gamify Adventure</h1>
                    <p class="subtitle">SMPN 42 Bandar Lampung</p>
                    
                    <div class="login-tabs">
                        <button class="tab-btn active" onclick="app.switchLoginTab('siswa')">Siswa</button>
                        <button class="tab-btn" onclick="app.switchLoginTab('guru')">Guru</button>
                    </div>

                    <form id="form-siswa" class="login-form active">
                        <div class="input-group">
                            <span class="icon">üéì</span>
                            <input type="text" id="nisn" placeholder="Masukkan NISN" required pattern="[0-9]*">
                        </div>
                        <div class="input-group">
                            <span class="icon">üë§</span>
                            <input type="text" id="nama-siswa" placeholder="Nama Lengkap" required>
                        </div>
                        <button type="submit" class="btn-start">MULAI PETUALANGAN ‚ñ∂</button>
                    </form>

                    <form id="form-guru" class="login-form">
                        <div class="input-group">
                            <span class="icon">üîë</span>
                            <input type="text" id="nip" placeholder="NIP / Kode Guru" required>
                        </div>
                        <div class="input-group">
                            <span class="icon">mr</span>
                            <input type="text" id="nama-guru" placeholder="Nama Guru" required>
                        </div>
                        <button type="submit" class="btn-admin">Masuk Panel Guru</button>
                    </form>
                </div>
            </div>
        </section>

        <!-- DASHBOARD GURU -->
        <section id="screen-admin" class="screen">
            <header class="game-header admin-header">
                <h2>üë®‚Äçüè´ Panel Guru</h2>
                <button class="btn-small" onclick="app.logout()">Keluar</button>
            </header>
            <div class="admin-content">
                <h3>Edit Bank Soal (Kelas 9)</h3>
                <div class="form-group">
                    <label>Pilih Level:</label>
                    <select id="admin-level-select" onchange="admin.loadQuestions()">
                        <option value="0">Level 1 - Matematika</option>
                        <option value="1">Level 2 - IPA</option>
                        <option value="2">Level 3 - Bahasa Inggris</option>
                        <option value="3">Level 4 - Bahasa Indonesia</option>
                        <option value="4">Level 5 - PKN</option>
                    </select>
                </div>
                <div id="admin-questions-list"></div>
                <button class="btn-save" onclick="admin.saveChanges()">üíæ Simpan Perubahan</button>
            </div>
        </section>

        <!-- MENU SISWA -->
        <section id="screen-menu" class="screen menu-bg">
            <header class="dashboard-header">
                <div class="player-profile" onclick="app.showProfile()">
                    <div class="avatar-circle">ü¶∏</div>
                    <div class="profile-text">
                        <h3 id="display-nama">Siswa</h3>
                        <span class="rank-badge">Lihat Profil</span>
                    </div>
                </div>
                <div class="currency-bar">
                    <div class="currency-item">‚≠ê <span id="total-stars">0</span></div>
                    <div class="currency-item">üèÜ <span id="total-score">0</span></div>
                </div>
            </header>

            <div class="gamification-layout">
                <div class="map-container">
                    <h2>üó∫Ô∏è Peta Perjalanan</h2>
                    <div class="path-wrapper" id="levels-list"></div>
                </div>

                <div class="sidebar">
                    <div class="card menu-actions">
                        <button class="btn-menu big" style="background:#6C63FF; color:white;" onclick="app.showProfile()">üë§ Profil Saya</button>
                        <button class="btn-menu big" onclick="app.showLeaderboard()">üèÜ Peringkat</button>
                        <button class="btn-menu logout" onclick="app.logout()">üö™ Keluar</button>
                    </div>
                    <div class="card badge-card">
                        <h3>Lencana Terbaru</h3>
                        <div class="badge-grid" id="badge-mini-container"></div>
                    </div>
                </div>
            </div>
        </section>

        <!-- GAMEPLAY SCREEN -->
        <section id="screen-game" class="screen">
            <canvas id="gameCanvas"></canvas>
            
            <div class="game-ui">
                <div class="hud-top">
                    <div class="hud-item" style="color:#ff4757; border:2px solid #ff4757; background:white;">
                        ‚ù§Ô∏è <span id="game-lives">3</span>
                    </div>
                    <div class="hud-item">üèÜ <span id="game-score">0</span></div>
                    <div class="hud-item">‚ùì <span id="game-q-count">0/5</span></div>
                    <button class="btn-icon" onclick="game.togglePause()">‚è∏</button>
                </div>
                
                <div class="controls-mobile">
                    <div class="d-pad">
                        <button id="btn-left">‚¨Ö</button>
                        <button id="btn-right">‚û°</button>
                    </div>
                    <button id="btn-jump">LOMPAT</button>
                </div>
            </div>

            <!-- Modal Quiz Regular -->
            <div id="modal-quiz" class="modal-overlay">
                <div class="modal-content quiz-box">
                    <div class="quiz-header">‚ùì TANTANGAN</div>
                    <p id="quiz-question-text">Soal...</p>
                    <div id="quiz-options" class="options-grid"></div>
                </div>
            </div>

            <!-- Modal Soal Sulit (Nyawa Habis) -->
            <div id="modal-emergency" class="modal-overlay" style="background: rgba(100,0,0,0.9);">
                <div class="modal-content quiz-box" style="border-color: red;">
                    <div class="quiz-header" style="background: red;">‚ö†Ô∏è BAHAYA! NYAWA HABIS</div>
                    <p style="font-size: 0.9rem; margin-bottom: 10px;">Jawab soal sulit ini dengan benar untuk mendapatkan <strong>1 Nyawa Tambahan</strong>!</p>
                    <p id="emergency-q-text" style="font-weight:bold; font-size:1.1rem;">Soal...</p>
                    <div id="emergency-options" class="options-grid"></div>
                </div>
            </div>

            <!-- Modal Pause -->
            <div id="modal-pause" class="modal-overlay">
                <div class="modal-content glass">
                    <h2>‚è∏ ISTIRAHAT</h2>
                    <button class="btn-start" onclick="game.togglePause()">Lanjut Main</button>
                    <button class="btn-menu" onclick="game.quitGame()">Kembali ke Peta</button>
                </div>
            </div>

            <!-- Modal Result -->
            <div id="modal-result" class="modal-overlay">
                <div class="modal-content result-box">
                    <div class="result-icon">üéâ</div>
                    <h2 id="result-title">LEVEL SELESAI!</h2>
                    <div class="stars-display" id="result-stars">‚≠ê‚≠ê‚≠ê</div>
                    <div class="result-stats">
                        <p>Skor: <strong id="result-score">0</strong></p>
                        <p>Benar: <strong id="result-correct">0</strong>/5</p>
                    </div>
                    <div class="result-actions">
                        <button class="btn-menu" onclick="game.restartLevel()">üîÑ Ulangi</button>
                        <button class="btn-start" onclick="game.quitGame()">Lanjut ‚ñ∂</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- PROFILE SCREEN -->
        <section id="screen-profile" class="screen">
            <div class="modal-content profile-box">
                <div class="close-modal" onclick="app.showScreen('screen-menu')">√ó</div>
                <div class="profile-header-card">
                    <div class="avatar-large">ü¶∏‚Äç‚ôÇÔ∏è</div>
                    <h2 id="prof-name">Nama Siswa</h2>
                    <p>NISN: <span id="prof-nisn">12345</span></p>
                </div>
                <div class="profile-stats-grid">
                    <div class="stat-card"><h3>Total Skor</h3><span id="prof-score">0</span></div>
                    <div class="stat-card"><h3>Bintang</h3><span id="prof-stars">0</span></div>
                </div>
                <h3>üèÖ Koleksi Lencana</h3>
                <div class="badge-grid" id="prof-badges" style="margin-top:10px; justify-content:center;"></div>
            </div>
        </section>
        
        <!-- LEADERBOARD SCREEN -->
        <section id="screen-leaderboard" class="screen">
            <div class="modal-content">
                <div class="close-modal" onclick="app.showScreen('screen-menu')">√ó</div>
                <h2>üèÜ Papan Peringkat</h2>
                <div class="leaderboard-list" id="leaderboard-list"></div>
            </div>
        </section>

    </div>

    <!-- AUDIO FILES -->
    <audio id="bgm-menu" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_c8c8a73467.mp3" type="audio/mpeg">
    </audio>
    <audio id="bgm-game" loop>
        <source src="https://cdn.pixabay.com/download/audio/2022/11/22/audio_febc508520.mp3" type="audio/mpeg">
    </audio>
    <!-- SFX -->
    <audio id="sfx-jump" src="https://cdn.pixabay.com/download/audio/2022/03/24/audio_0788523c11.mp3"></audio>
    <audio id="sfx-coin" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_bb630cc098.mp3"></audio>
    <audio id="sfx-wrong" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_c6ccf3232f.mp3"></audio>
    <audio id="sfx-win" src="https://cdn.pixabay.com/download/audio/2021/08/04/audio_12b0c7443c.mp3"></audio>
    <audio id="sfx-hit" src="https://cdn.pixabay.com/download/audio/2022/03/10/audio_c66c30f808.mp3"></audio>

    <script src="script.js"></script>
</body>
</html>